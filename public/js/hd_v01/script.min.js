function loadlazy(){var e=$(".bd"),t=$(".section",e);t.visibleWatcher({onVisible:function(e,n){t.filter(function(e){return e<=n+1}).addClass("preload").find("img").each(function(){var e=$(this).attr("data-src");$(this).attr("src",e)})}})}function navEvent(){var e=$("#J_nav"),t=e.offset().top,n=0,o="";$(window).on("scroll",function(){(n=$(this).scrollTop())>=t?e.addClass("nav-fixed"):e.removeClass("nav-fixed")}),e.find("li").on("click",function(){return(o=$(this).attr("data-target"))&&$(o).length&&$("html, body").animate({scrollTop:$(o).offset().top-e.height()},500),!1})}function tabSwitch(){var e=$(".tab-active"),t=$(".tab-content").find("a"),n=e.find(".items"),o=0,i="",a=function(){n.removeClass("active").eq(o).addClass("active"),t.removeClass("active").eq(o).addClass("active")},s=function(){i=setInterval(function(){10===++o&&(o=0),a()},3e3)};s(),n.hover(function(){clearInterval(i)},function(){s()}),n.on("click",function(){return o=$(this).index(),a(),!1})}function modalInfor(){var e=$(".rule"),t=$(".buchang"),n=$("#J_modalRule"),o=$("#J_modalBuchang");e.on("click",function(e){e.preventDefault(),n.modal("show")}),t.on("click",function(e){e.preventDefault(),o.modal("show")})}function luckDraw618(){var e=0,t=$("#J_draw618"),n=$("#J_uscoreTotal"),o=$("#J_modalDrawResult"),i="/controller/hd_v01/api_draw.json",a=function(){location.href=""+location.href},s=function(){e>0&&n.text(e).parent().show(),e<=0&&t.addClass("btn-disable")};_common.sendAjax(i,{},"json",function(t){if(t&&"result"===t.code){var n=t.data;e=n.uscore,s()}else a()});var r=function(e,t){if(e){var n="";1===e?n="modal-draw-faild":2===e?n="modal-draw-noscore":3===e&&(n="modal-draw-lucky",$("#J_drawPrizeName").html(t.prizeName)),o.removeClass("modal-draw-faild modal-draw-lucky modal-draw-noscore").addClass(n).modal("show")}};t.on("click",function(){if(e<1)return r(2),!1;_common.sendAjax(i,{},"json",function(t){if(t&&"result"===t.code){var n=t.data;r(3,n.userPrizeInfo)}else r(1);e=n.uscore,s()})}),$("#J_showPrize").on("click",function(){return $.ajax({url:"/controller/hd_v01/api_prize.json",dataType:"jsonp",jsonp:"jsonpcallback",success:function(e){e&&0===e.code?r(3,e.data[0]):r(1)}}),!1})}function shareWeibo(e){var t={title:"",pic:"",url:"",key:""},n=$.extend({},t,e);window.open("http://service.weibo.com/share/share.php?title="+encodeURIComponent(n.title)+"&url="+encodeURIComponent(n.url)+"&appkey="+encodeURIComponent(n.key)+"&pic="+encodeURIComponent(n.pic),"_blank","scrollbars=no,width=600,height=450,left=75,top=20,status=no,resizable=yes")}!function(){"use strict";function e(t,n,o){return("string"==typeof n?n:n.toString()).replace(t.define||a,function(e,n,i,a){return 0===n.indexOf("def.")&&(n=n.substring(4)),n in o||(":"===i?(t.defineParams&&a.replace(t.defineParams,function(e,t,i){o[n]={arg:t,text:i}}),n in o||(o[n]=a)):new Function("def","def['"+n+"']="+a)(o)),""}).replace(t.use||a,function(n,i){t.useParams&&(i=i.replace(t.useParams,function(e,t,n,i){if(o[n]&&o[n].arg&&i){var a=(n+":"+i).replace(/'|\\/g,"_");return o.__exp=o.__exp||{},o.__exp[a]=o[n].text.replace(new RegExp("(^|[^\\w$])"+o[n].arg+"([^\\w$])","g"),"$1"+i+"$2"),t+"def.__exp['"+a+"']"}}));var a=new Function("def","return "+i)(o);return a?e(t,a,o):a})}function t(e){return e.replace(/\\('|\\)/g,"$1").replace(/[\r\t\n]/g," ")}var n,o={version:"1.0.3",templateSettings:{evaluate:/\{\{([\s\S]+?(\}?)+)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,encode:/\{\{!([\s\S]+?)\}\}/g,use:/\{\{#([\s\S]+?)\}\}/g,useParams:/(^|[^\w$])def(?:\.|\[[\'\"])([\w$\.]+)(?:[\'\"]\])?\s*\:\s*([\w$\.]+|\"[^\"]+\"|\'[^\']+\'|\{[^\}]+\})/g,define:/\{\{##\s*([\w\.$]+)\s*(\:|=)([\s\S]+?)#\}\}/g,defineParams:/^\s*([\w$]+):([\s\S]+)/,conditional:/\{\{\?(\?)?\s*([\s\S]*?)\s*\}\}/g,iterate:/\{\{~\s*(?:\}\}|([\s\S]+?)\s*\:\s*([\w$]+)\s*(?:\:\s*([\w$]+))?\s*\}\})/g,varname:"it",strip:!0,append:!0,selfcontained:!1,doNotSkipEncoded:!1},template:void 0,compile:void 0};o.encodeHTMLSource=function(e){var t={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},n=e?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(e){return e?e.toString().replace(n,function(e){return t[e]||e}):""}},n=function(){return this||(0,eval)("this")}(),"undefined"!=typeof module&&module.exports?module.exports=o:"function"==typeof define&&define.amd?define(function(){return o}):n.doT=o;var i={append:{start:"'+(",end:")+'",startencode:"'+encodeHTML("},split:{start:"';out+=(",end:");out+='",startencode:"';out+=encodeHTML("}},a=/$^/;o.template=function(s,r,c){var d,l,u=(r=r||o.templateSettings).append?i.append:i.split,f=0,h=r.use||r.define?e(r,s,c||{}):s;h=("var out='"+(r.strip?h.replace(/(^|\r|\n)\t* +| +\t*(\r|\n|$)/g," ").replace(/\r|\n|\t|\/\*[\s\S]*?\*\//g,""):h).replace(/'|\\/g,"\\$&").replace(r.interpolate||a,function(e,n){return u.start+t(n)+u.end}).replace(r.encode||a,function(e,n){return d=!0,u.startencode+t(n)+u.end}).replace(r.conditional||a,function(e,n,o){return n?o?"';}else if("+t(o)+"){out+='":"';}else{out+='":o?"';if("+t(o)+"){out+='":"';}out+='"}).replace(r.iterate||a,function(e,n,o,i){return n?(f+=1,l=i||"i"+f,n=t(n),"';var arr"+f+"="+n+";if(arr"+f+"){var "+o+","+l+"=-1,l"+f+"=arr"+f+".length-1;while("+l+"<l"+f+"){"+o+"=arr"+f+"["+l+"+=1];out+='"):"';} } out+='"}).replace(r.evaluate||a,function(e,n){return"';"+t(n)+"out+='"})+"';return out;").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/(\s|;|\}|^|\{)out\+='';/g,"$1").replace(/\+''/g,""),d&&(r.selfcontained||!n||n._encodeHTML||(n._encodeHTML=o.encodeHTMLSource(r.doNotSkipEncoded)),h="var encodeHTML = typeof _encodeHTML !== 'undefined' ? _encodeHTML : ("+o.encodeHTMLSource.toString()+"("+(r.doNotSkipEncoded||"")+"));"+h);try{return new Function(r.varname,h)}catch(e){throw"undefined"!=typeof console&&console.log("Could not create a template function: "+h),e}},o.compile=function(e,t){return o.template(e,null,t)}}(),function(e){"use strict";function t(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var n in t)if(void 0!==e.style[n])return{end:t[n]};return!1}e.fn.emulateTransitionEnd=function(t){var n=!1,o=this;e(this).one(e.support.transition.end,function(){n=!0});return setTimeout(function(){n||e(o).trigger(e.support.transition.end)},t),this},e(function(){e.support.transition=t()})}(jQuery),function(e){"use strict";var t=function(t,n){this.options=n,this.$element=e(t).delegate('[data-dismiss="modal"]',"click.dismiss.modal",e.proxy(this.hide,this)),this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};t.prototype={constructor:t,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var t=this,n=e.Event("show");this.$element.trigger(n),this.isShown||n.isDefaultPrevented()||(this.isShown=!0,this.escape(),this.backdrop(function(){var n=e.support.transition&&t.$element.hasClass("fade");t.$element.parent().length||t.$element.appendTo(document.body),t.$element.show(),n&&t.$element[0].offsetWidth,t.$element.addClass("in").attr("aria-hidden",!1),t.enforceFocus(),n?t.$element.one(e.support.transition.end,function(){t.$element.focus().trigger("shown")}):t.$element.focus().trigger("shown")}))},hide:function(t){t&&t.preventDefault();t=e.Event("hide"),this.$element.trigger(t),this.isShown&&!t.isDefaultPrevented()&&(this.isShown=!1,this.escape(),e(document).off("focusin.modal"),this.$element.removeClass("in").attr("aria-hidden",!0),e.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal())},enforceFocus:function(){var t=this;e(document).on("focusin.modal",function(e){t.$element[0]===e.target||t.$element.has(e.target).length||t.$element.focus()})},escape:function(){var e=this;this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.modal",function(t){27==t.which&&e.hide()}):this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var t=this,n=setTimeout(function(){t.$element.off(e.support.transition.end),t.hideModal()},500);this.$element.one(e.support.transition.end,function(){clearTimeout(n),t.hideModal()})},hideModal:function(){var e=this;this.$element.hide(),this.backdrop(function(){e.removeBackdrop(),e.$element.trigger("hidden")})},removeBackdrop:function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},backdrop:function(t){var n=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var o=e.support.transition&&n,i=e(document).height();if(this.$backdrop=e('<div class="modal-backdrop '+n+'" />').appendTo(document.body),this.$backdrop.css({width:"100%",height:i}).click("static"==this.options.backdrop?e.proxy(this.$element[0].focus,this.$element[0]):e.proxy(this.hide,this)),o&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!t)return;o?this.$backdrop.one(e.support.transition.end,t):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(e.support.transition.end,t):t()):t&&t()}};var n=e.fn.modal;e.fn.modal=function(n){return this.each(function(){var o=e(this),i=o.data("modal"),a=e.extend({},e.fn.modal.defaults,o.data(),"object"==typeof n&&n);i||o.data("modal",i=new t(this,a)),"string"==typeof n?i[n]():a.show&&i.show()})},e.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},e.fn.modal.Constructor=t,e.fn.modal.noConflict=function(){return e.fn.modal=n,this},e(document).on("click.modal.data-api",'[data-toggle="modal"]',function(t){var n=e(this),o=n.attr("href"),i=e(n.attr("data-target")||o&&o.replace(/.*(?=#[^\s]+$)/,"")),a=i.data("modal")?"toggle":e.extend({remote:!/#/.test(o)&&o},i.data(),n.data());t.preventDefault(),i.modal(a).one("hide",function(){n.focus()})})}(window.jQuery),function(e){function t(t){function n(){for(var t=-1,n=e(document).scrollTop(),o=0,i=d.length;o<i&&n+s.viewport.height()>d[o];o+=1)t+=1;return t}function o(){var t=n();c!==t&&(c=t,r.filter(function(t){return t<=c&&!e(this).hasClass(s.visibleClass)}).addClass(s.visibleClass).trigger("visible.visibleWatcher"),s.onVisible(r.eq(c),c))}function i(){r.each(function(){var t=e(this).attr("data-offset")?Number(e(this).attr("data-offset")):s.offset,n=t%1==0?t:t*s.viewport.height();d.push(e(this).offset().top+n)}),o(),s.onLoad()}var a,s,r=e(this),c=-1,d=[];a={viewport:e(window),visibleClass:"is-visible",offset:300,onLoad:e.noop,onVisible:e.noop},s=e.extend({},a,t),i(),s.viewport.on({"scroll.visibleWatcher":o,"resize.visibleWatcher":i})}e.fn.visibleWatcher=function(e){return t.call(this,e),this}}(jQuery);var apiBanner="/controller/hd_v01/api_banner.json",apiPhone="/controller/hd_v01/api_phone.json",_common={sendAjax:function(e,t,n,o){$.ajax({url:e,data:t,dataType:n,success:o})}};window.vm=new Vue({el:"#web",data:{headerTitle:"",headerDesc:"10大惊喜不间断放送，红米Note 3 全网通直降100",headerDesc1:"手机天天现货，小米Max 高配版等 6 大新品首发，还有 3 大专属福利",surpriseTitle:"10大惊喜不间断",surpriseDesc:"小米5 现货购买、小米Max 高配版首卖、红米Note 3 全网通直降100",surpriseDesc1:"还有更多惊喜不间断，狂欢20天",phoneTitle:"明星手机天天现货",phoneDesc:"小米5 标准版 / 高配版现货购买，小米Max 每天早 10 点现货，全系红米手机天天有",newProductTitle:"首发新品抢先拥有",newProductDesc:"米家 LED 智能台灯、小米手环2 等重量级新品将陆续发布",mitvTitle:"小米电视3 最高降300",mitvDesc:"全系电视买就送 3 个月小米电视 + 爱奇艺 VIP 会员(价值 88 元），电视/盒子有特惠、领券省更多",smartTitle:"智能硬件 最多省50",smartDesc:"买小米净水器，抽奖赢滤芯，空气净化器2 直降50，还有多款爆品特惠",accessTitle:"配件特惠 全场8折起",accessDesc:"蓝牙音箱、移动电源、旅行箱等配件特惠，还有多款商品包邮",welfareTitle:"3大专属福利",welfareDesc:"618 活动期间，小米商城准备了 3 大专属福利",welfareDesc1:"抽奖赢幸运大礼包、新机红包、晒单赢好礼，抢先拥有小米5 尊享版、小米手环2",bannerTitle:[],bannerList:[],navList:[],phoneList:[],newProductList:[],mitvList:[],smartList:[],accessoriesList:[]}}),_common.sendAjax(apiBanner,{},"json",function(e){if("result"!==e.code)return!1;window.slotData=e.data,window.vm.navList=window.slotData.nav,window.vm.bannerTitle=window.slotData.bannerTitle,window.vm.bannerList=window.slotData.banner,_common.sendAjax(apiPhone,{},"json",function(e){if("result"!==e.code)return!1;window.slotProductData=e.data,window.vm.phoneList=window.slotProductData.phone,window.vm.newProductList=window.slotProductData.newProduct,window.vm.mitvList=window.slotProductData.mitv,window.vm.smartList=window.slotProductData.smart,window.vm.accessoriesList=window.slotProductData.accessories,modalInfor(),navEvent(),tabSwitch(),loadlazy()})});var getServerTime=function(){var e=parseInt(Date.parse(new Date("2017/10/8 00:00:00"))/1e3),t=parseInt(Date.parse(new Date("2017/12/10 00:00:00"))/1e3),n=function(n){n>=e&&n<t?$(".J_btn618").each(function(){$(this).text($(this).attr("data-start-text")).removeClass("btn-disable")}):n>=t&&$(".J_btn618").each(function(){$(this).addClass("btn-disable").text("活动已结束")})};_common.sendAjax("http://tptm.hd.mi.com/gettimestamp",{},"script",function(e){void 0===e&&"number"!=typeof e&&(e=Date.parse(new Date)/1e3),n(e)})};getServerTime(),luckDraw618(),$("#J_sharePrize").on("click",function(){return shareWeibo({title:"太幸运啦，我在@小米商城 狂欢20天活动抽中幸运大礼包，还能抢先拥有小米5 尊享版！这么好的福利我通常不告诉别人的，去瞧瞧 →",pic:"",href:location.href}),!1});